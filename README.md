# RustCxx_11

C++11/14/17 port of [RustCxx](https://github.com/DapengFeng/RustCxx), using [variant-lite](https://github.com/martinmoene/variant-lite) and [optional-lite](https://github.com/martinmoene/optional-lite)

**NOTE:** currently just modified files in include, examples and cmake won't work.

[Original README is here](README_ORIG.md)

## Install

**WARNING:** This repository contains codes generated by Github Copilot. Use with care.

Just copy files in `include` into your project.

## Usage

### Enum

```cpp
#include "rustcxx.hpp"

using namespace rust;

// Define enum variants (C++17 or later)
// ENUM_VARIANT(Red);
// ENUM_VARIANT(Green);
// ENUM_VARIANT(Blue, int intensity);

// Define enum variants (C++11/13)
ENUM_VARIANT0(Red);
ENUM_VARIANT0(Green);
ENUM_VARIANT1(Blue, int, intensity);

using Color = Enum<Red, Green, Blue>;

// Usage
Color color = Blue{128};

// Pattern matching
auto description = color.match(
    [](const Red&)   { return std::string("It's red!"); },
    [](const Green&) { return std::string("It's green!"); },
    [](const Blue& b) {
        return std::string("It's blue with intensity ") + std::to_string(b.intensity);
    }
);

std::cout << description << std::endl;
```

### Result

```cpp
auto divide = [](int a, int b) -> Result<double, std::string> {
    if (b == 0) {
        return Result<double, std::string>::Err("Division by zero!");
    }
    return Result<double, std::string>::Ok(static_cast<double>(a) / b);
};

auto result = divide(10, 2);

// Pattern matching
result.match(
    [](double value) { std::cout << "Result: " << value << std::endl; },
    [](const std::string& error) { std::cout << "Error: " << error << std::endl; }
);

// Safe access
double value = result.unwrap_or(-1.0);

// Chaining
auto chained = divide(20, 4)
    .map([](double x) { return x * 2; })
    .and_then([&](double x) { return divide(static_cast<int>(x), 2); });
```

### Option

```cpp
auto find_user = [](int id) -> Option<std::string> {
    if (id == 1) return Option<std::string>::Some("Alice");
    if (id == 2) return Option<std::string>::Some("Bob");
    return Option<std::string>::None();
};

auto user = find_user(1);

// Pattern matching
user.match(
    [](const std::string& name) { std::cout << "Found: " << name << std::endl; },
    []() { std::cout << "User not found" << std::endl; }
);

// Chaining operations
auto greeting = find_user(1)
    .map([](const std::string& name) { return "Hello, " + name + "!"; })
    .unwrap_or("Hello, stranger!");
```

## License

Apache-2.0

- [RustCxx](https://github.com/DapengFeng/RustCxx): Apache-2.0
- [variant-lite](https://github.com/martinmoene/variant-lite): BSL-1.0
- [optional-lite](https://github.com/martinmoene/optional-lite): BSL-1.0
